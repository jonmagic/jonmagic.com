<!DOCTYPE html>
<html lang="en">
<head>
  <script defer data-domain="jonmagic.com" src="https://plausible.io/js/script.outbound-links.js"></script>
<script>window.plausible = window.plausible || function() { (window.plausible.q = window.plausible.q || []).push(arguments) }</script>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1">
<title>Compiling Executables on Heroku</title>


<meta property="og:title" content="Compiling Executables on Heroku">
<meta property="og:description" content="Need pdftotext on Heroku? Discover a smooth hack for compiling executables directly on Heroku&#39;s Cedar Stack, making PDFs searchable in no time!">
<meta property="og:url" content="https://jonmagic.com/posts/compiling-executables-on-heroku/">
<meta property="og:site_name" content="jonmagic.com">
<meta property="og:type" content="article">
<meta property="og:image" content="https://jonmagic.com/images/avatars/jonmagic-2023-01-18.webp">
<meta property="og:locale" content="en_US">


<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="Compiling Executables on Heroku">
<meta name="twitter:description" content="Need pdftotext on Heroku? Discover a smooth hack for compiling executables directly on Heroku&#39;s Cedar Stack, making PDFs searchable in no time!">


<meta name="description" content="Need pdftotext on Heroku? Discover a smooth hack for compiling executables directly on Heroku&#39;s Cedar Stack, making PDFs searchable in no time!">
<meta name="author" content="Jonathan Hoyt">

<link rel="icon" href="/favicon.ico" type="image/x-icon">

<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/normalize/8.0.1/normalize.min.css"
      integrity="sha512-NhSC1YmyruXifcj/KFRWoC561YpHpc5Jtzgvbuzx5VozKpWvQ+4nXhPdFgmx8xqexRcpAglTj9sIBWINXa8x5w=="
      crossorigin="anonymous" referrerpolicy="no-referrer" />
<link rel="stylesheet" href="/css/base.css">
<link rel="stylesheet" href="/css/search.css">
<link rel="alternate" type="application/atom+xml" title="JonMagic.com RSS Feed" href="/feed.xml">

</head>

<body class="">
  
  <nav class="site-nav">
  <div class="nav-container">
    <ul class="nav-links"><li><a href="/">Home</a></li><li><a href="/posts/">Posts</a></li><li><a href="/projects/">Projects</a></li><li><a href="/search/">Search</a></li><li><a href="/about/">About</a></li></ul>
    <div class="social-links">
      <a href="https://github.com/jonmagic" title="GitHub Profile">
        <img src="/images/github.png" alt="GitHub Profile" width="24" height="24" class="github-icon">
      </a>
      <a href="https://linkedin.com/in/jonmagic" title="LinkedIn Profile">
        <img src="/images/linkedin.png" alt="LinkedIn Profile" width="24" height="24" class="linkedin-icon">
      </a>
      <a href="/feed.xml" title="RSS Feed">
        <img src="/images/rss.png" alt="RSS Feed" width="24" height="24" class="rss-icon">
      </a>
    </div>
  </div>
</nav>

  <div class="page layout-main">
    <main class="content">
      
      <div class="post-date-container">
        <span id="post-date-typing" class="post-date-typing" data-date="2011-07-28"></span>
      </div>
      
      <h1 class="site-title">Compiling Executables on Heroku</h1>
      <p>Are you using Heroku and want to run a program not included in the Heroku environment? I’m going to show you how.</p>
<p>For <a href="http://speakerdeck.com">Speaker Deck</a> we wanted to be able to extract the text from uploaded pdf’s so that we can index them and make them searchable, but the program we’d been using to do this on our dev machines, pdftotext (part of the <a href="http://foolabs.com/xpdf/">XPDF</a> library), wasn’t available on our <a href="http://heroku.com">Heroku</a> instances.</p>
<p>On a whim I typed “heroku run bash” and sure enough I was dropped into a bash shell with our Heroku Cedar Stack instance.</p>
<pre class="language-bash"><code class="language-bash">heroku run <span class="token function">bash</span></code></pre>
<p>Then I went into our app’s tmp directory and tried a wget with the xpdf url, but it failed so I tried curl with the -o option to output to file and it worked. Then I unzipped the file and started building it!</p>
<pre class="language-bash"><code class="language-bash"><span class="token function">curl</span> ftp://ftp.foolabs.com/pub/xpdf/xpdf-3.02.tar.gz <span class="token parameter variable">-o</span> xpdf.tar.gz
<span class="token function">tar</span> zxvf xpdf.tar.gz
<span class="token builtin class-name">cd</span> xpdf-3.02
./configure
<span class="token function">make</span></code></pre>
<p>When it was done building I found the executable we needed, pdftotext, sitting in the xpdf build directory. I scp’d it to my machine, created a bin directory in our app’s folder, and stuck the executable there. Then with a quick git commit and git push to Heroku we were in business!</p>
<p>If I had an environment locally that was identical to the Heroku instance I could have built it locally, but to ensure it was built to run on the Heroku instance it just made sense to build it there in the first place.</p>
<p>The bin directory was added to the app’s path automatically so I was able to execute the pdftotext program from inside our Rails app without a hitch.</p>
<p><strong>Update:</strong> Josh Peek commented on the <a href="http://news.ycombinator.com/item?id=2816783">Hacker News post</a> that he bundled the xpdf source in a <a href="https://github.com/josh/ruby-xpdf">gem which compiles itself at runtime</a>… Probably a better longterm solution as it works if the underlying environment changes enough to break a prebuilt binary.</p>

    </main>
  </div>
  
  <div class="page">
    <footer>
  © Jonathan Hoyt <span id="year"></span> — built <s>by hand</s> with an LLM
</footer>

  </div>
  <script src="/js/site.js"></script>
</body>
</html>
